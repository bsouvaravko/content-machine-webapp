<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>PRO –ú–æ–Ω—Ç–∞–∂</title>
    <link rel="stylesheet" href="styles.css?v=2">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="app-container" id="app">
        
        <!-- –≠–ö–†–ê–ù 1: –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –º–æ–Ω—Ç–∞–∂–∞ -->
        <div class="screen" id="screen-mode" data-screen="1">
            <h1 class="screen-title">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –º–æ–Ω—Ç–∞–∂–∞</h1>
            <div class="mode-buttons">
                <button class="mode-btn" onclick="selectMode('split_screen')">
                    <span class="mode-icon">üì±</span>
                    <span class="mode-label">–†–∞–∑–¥–µ—Ä–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞</span>
                </button>
                <button class="mode-btn" onclick="selectMode('corner')">
                    <span class="mode-icon">üìê</span>
                    <span class="mode-label">–í —É–≥–ª—É —ç–∫—Ä–∞–Ω–∞</span>
                </button>
                <button class="mode-btn" onclick="selectMode('video_insert')">
                    <span class="mode-icon">üé¨</span>
                    <span class="mode-label">–í–∏–¥–µ–æ-–≤—Å—Ç–∞–≤–∫–∏</span>
                </button>
            </div>
        </div>

        <!-- –≠–ö–†–ê–ù 2: –í—ã–±–æ—Ä/–∑–∞–≥—Ä—É–∑–∫–∞ –≤—Ç–æ—Ä–æ–≥–æ –≤–∏–¥–µ–æ -->
        <div class="screen hidden" id="screen-video" data-screen="2">
            <h1 class="screen-title">–†–µ–∂–∏–º: <span id="selected-mode-title"></span></h1>
            
            <div class="video-grid">
                <!-- –î–æ–ø. –≤–∏–¥–µ–æ (–∑–∞–≥—Ä—É–∑–∫–∞) -->
                <div class="video-card-upload">
                    <div class="video-upload-box" onclick="document.getElementById('video-file').click()">
                        <input type="file" id="video-file" accept="video/*" style="display:none;" onchange="handleVideoUpload(event)">
                        <div class="upload-placeholder">
                            <span class="upload-icon">üìÅ</span>
                            <span class="upload-text">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –≤–∏–¥–µ–æ –∏–ª–∏ –∫–ª–∏–∫–Ω–∏—Ç–µ</span>
                        </div>
                    </div>
                    <div class="video-label">–î–æ–ø. –≤–∏–¥–µ–æ</div>
                </div>
                
                <!-- –í–∏–¥–µ–æ —Å –∞–≤–∞—Ç–∞—Ä–æ–º (–∏–∑ HeyGen) -->
                <div class="video-card">
                    <div class="video-preview-box avatar-video" id="avatar-video-preview">
                        <div class="avatar-placeholder">
                            <div class="avatar-icon">üë§</div>
                            <div class="avatar-text">–í–∏–¥–µ–æ –∏–∑ HeyGen</div>
                        </div>
                    </div>
                    <div class="video-label">–í–∏–¥–µ–æ —Å –∞–≤–∞—Ç–∞—Ä–æ–º</div>
                </div>
            </div>

            <!-- –ü—Ä–µ–≤—å—é –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –≤–∏–¥–µ–æ (–≤–Ω–∏–∑—É) -->
            <div class="uploaded-video-preview hidden" id="uploaded-preview">
                <div class="preview-video-box">
                    <video id="preview-uploaded-video" loop muted playsinline></video>
                </div>
            </div>
        </div>

        <!-- –≠–ö–†–ê–ù 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø—Ä–µ–≤—å—é –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ -->
        <div class="screen hidden" id="screen-settings" data-screen="3">
            
            <!-- –ö–æ–º–ø–æ–∑–∏—Ç–Ω–æ–µ –ø—Ä–µ–≤—å—é (–¥–≤–∞ –≤–∏–¥–µ–æ) -->
            <div class="composition-preview">
                <!-- –í–∏–¥–µ–æ 1 (–¥–æ–ø. –≤–∏–¥–µ–æ) -->
                <div class="comp-video comp-video-1" id="comp-video-1">
                    <div class="comp-placeholder">–î–æ–ø. –≤–∏–¥–µ–æ</div>
                </div>
                <!-- –í–∏–¥–µ–æ 2 (–∞–≤–∞—Ç–∞—Ä) -->
                <div class="comp-video comp-video-2" id="comp-video-2">
                    <div class="comp-placeholder">–ê–≤–∞—Ç–∞—Ä</div>
                    <!-- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ–±–ª–∞—Å—Ç–∏ -->
                    <div class="comp-overlay">
                        <div class="comp-chart">
                            <div class="chart-bar" style="height: 40%"></div>
                            <div class="chart-bar" style="height: 60%"></div>
                            <div class="chart-bar" style="height: 50%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
            <div class="settings-panel">
                
                <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Å–≤–æ—Ä–∞—á–∏–≤–∞–µ–º—ã–µ) -->
                <div class="setting-group">
                    <div class="setting-header" onclick="toggleGroup('main-settings')">
                        <span class="toggle-icon collapsed" id="toggle-main-settings">‚ñ∂</span>
                        <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                    </div>
                    <div class="setting-content collapsed" id="main-settings">
                        
                        <!-- –ü–æ–∑–∏—Ü–∏—è –∞–≤–∞—Ç–∞—Ä–∞ -->
                        <div class="setting-item">
                            <label class="setting-label">–ü–æ–∑–∏—Ü–∏—è –∞–≤–∞—Ç–∞—Ä–∞:</label>
                            <select class="setting-select" id="avatar-position" onchange="updateState('avatarPosition', this.value); updateComposition();">
                                <option value="top">–°–≤–µ—Ä—Ö—É</option>
                                <option value="bottom">–°–Ω–∏–∑—É</option>
                                <option value="left">–°–ª–µ–≤–∞</option>
                                <option value="right">–°–ø—Ä–∞–≤–∞</option>
                            </select>
                        </div>

                        <!-- –î–æ–ª—è —ç–∫—Ä–∞–Ω–∞ -->
                        <div class="setting-item">
                            <label class="setting-label">
                                –î–æ–ª—è —ç–∫—Ä–∞–Ω–∞ –ø–æ–¥ –æ—Å–Ω. –≤–∏–¥–µ–æ: <span id="screen-value">50</span>%
                            </label>
                            <input type="range" class="setting-slider" id="screen-ratio" 
                                   min="0" max="100" value="50" 
                                   oninput="updateSlider('screen', this.value); updateComposition();">
                        </div>

                        <!-- –ú–∞—Å—à—Ç–∞–± –ª–∏—Ü–∞ -->
                        <div class="setting-item">
                            <label class="setting-label">
                                –ú–∞—Å—à—Ç–∞–± –ª–∏—Ü–∞: <span id="scale-value">50</span>%
                            </label>
                            <input type="range" class="setting-slider" id="face-scale" 
                                   min="0" max="100" value="50" 
                                   oninput="updateSlider('scale', this.value);">
                        </div>

                    </div>
                </div>

                <!-- –î–æ–±–∞–≤–∏—Ç—å —Å—É–±—Ç–∏—Ç—Ä—ã (—á–µ–∫–±–æ–∫—Å) -->
                <div class="setting-group">
                    <div class="setting-header checkbox-header">
                        <label class="checkbox-container">
                            <input type="checkbox" id="add-subtitles" onchange="toggleSubtitles(this.checked)">
                            <span class="checkbox-label">–î–æ–±–∞–≤–∏—Ç—å —Å—É–±—Ç–∏—Ç—Ä—ã</span>
                        </label>
                    </div>
                </div>

                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—É–±—Ç–∏—Ç—Ä–æ–≤ (—Å–≤–æ—Ä–∞—á–∏–≤–∞–µ–º—ã–µ) -->
                <div class="setting-group hidden" id="subtitle-group">
                    <div class="setting-header" onclick="toggleGroup('subtitle-settings')">
                        <span class="toggle-icon collapsed" id="toggle-subtitle-settings">‚ñ∂</span>
                        <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—É–±—Ç–∏—Ç—Ä–æ–≤</span>
                    </div>
                    <div class="setting-content collapsed" id="subtitle-settings">
                        
                        <!-- –¢–∏–ø —Å—É–±—Ç–∏—Ç—Ä–æ–≤ -->
                        <div class="setting-item">
                            <div class="radio-group">
                                <label class="radio-container">
                                    <input type="radio" name="subtitle-type" value="template" checked 
                                           onchange="updateState('subtitleType', this.value)">
                                    <span class="radio-label">–®–∞–±–ª–æ–Ω</span>
                                </label>
                                <label class="radio-container">
                                    <input type="radio" name="subtitle-type" value="manual" 
                                           onchange="updateState('subtitleType', this.value)">
                                    <span class="radio-label">–†—É—á–Ω–∞—è</span>
                                </label>
                            </div>
                        </div>

                        <!-- –®–∞–±–ª–æ–Ω -->
                        <div class="setting-item">
                            <label class="setting-label">–®–∞–±–ª–æ–Ω:</label>
                            <select class="setting-select" id="subtitle-template" onchange="updateState('subtitleTemplate', this.value)">
                                <option value="minimal_clean">Minimal Clean</option>
                                <option value="modern_bold">Modern Bold</option>
                                <option value="elegant">Elegant</option>
                                <option value="neon">Neon</option>
                            </select>
                        </div>

                        <!-- –ü–æ–ª–æ–∂–µ–Ω–∏–µ —Å—É–±—Ç–∏—Ç—Ä–æ–≤ -->
                        <div class="setting-item">
                            <label class="setting-label">–ü–æ–ª–æ–∂–µ–Ω–∏–µ —Å—É–±—Ç–∏—Ç—Ä–æ–≤:</label>
                            <select class="setting-select" id="subtitle-position" onchange="updateState('subtitlePosition', this.value)">
                                <option value="top">–°–≤–µ—Ä—Ö—É</option>
                                <option value="center">–ü–æ —Ü–µ–Ω—Ç—Ä—É</option>
                                <option value="bottom" selected>–°–Ω–∏–∑—É</option>
                            </select>
                        </div>

                        <!-- –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ -->
                        <div class="setting-item">
                            <label class="setting-label">
                                –†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞: <span id="font-value">30</span> px
                            </label>
                            <input type="range" class="setting-slider" id="font-size" 
                                   min="10" max="60" value="30" 
                                   oninput="updateSlider('font', this.value);">
                        </div>

                    </div>
                </div>

            </div>
            
            <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ (fallback –µ—Å–ª–∏ MainButton –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç) -->
            <div style="padding: 20px;">
                <button onclick="launchMontage()" style="
                    width: 100%;
                    padding: 15px 30px;
                    font-size: 18px;
                    font-weight: bold;
                    background: #4CAF50;
                    color: white;
                    border: none;
                    border-radius: 12px;
                    cursor: pointer;
                    box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
                    transition: all 0.3s;
                ">
                    üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å
                </button>
            </div>

        </div>

    </div>

    <script src="script.js?v=5"></script>
</body>
</html>
